---
layout:     post                    
title:      支持内存大页的虚拟机热迁移               
subtitle:   linux内存大页配置方法及具有内存大页特性的虚拟机热迁移流程 
date:       2020-12-03             
author:     xinxin                     
header-img: img/post-bg-rwd.jpg    
catalog: true                       
mathjax: true
tags:                               
    - 热迁移
    - 大页内存
---
# （一）配置大页内存方法
1. 修改系统启动配置文件：vim /etc/default/grub，在GRUB_CMDLINE_LINUX标签中添加hugepagesz=<pagesize> hugepages=<pagenumber> default\_hugepagesz=1GB。hugepagesz是页的大小，取值为1GB;hugepages是页数，二者相乘就是配置的大页内存数。比如配置4G的页内存大小为1GB的大页内存，hugepagesz=1GB hugepages=4 default_hugepagesz=1GB。
2. 执行grub2-mkconfig -o /boot/grub2/grub.cfg命令重新生成配置文件。
3. 执行reboot重启主机生效。
4. 主机重启后查看配置是否生效，执行cat /proc/cmdline查看GRUB_CMDLINE_LINUX中是否有大页内存的配置；执行cat /proc/meminfo $\mid$ grep Huge查看结果。  
Hugepage\_Total是大页内存的总页数，HugePages_Free是可用页数，HugePagesize是页的大小。

# 支持内存大页的虚拟机热迁移

